import{d as e,C as a,W as t,_ as l,N as o,e as r,u as s,a as d,b as n,r as i,c as u,f as m,o as p,g as c,h as g,w as f,X as h,Y as b,Z as v,$ as C,a0 as w,j as _,t as S,p as k,k as y,i as N,a1 as R}from"./index.8b07ba7d.js";import{s as x,N as B}from"./RadioGroup.9b5b92d9.js";import{N as $,a as I}from"./FormItem.21828408.js";import{u as F}from"./use-notification.ba77bf42.js";import"./get-slot.65c4337d.js";var j=e({name:"RadioButton",props:x.props,setup:e=>x(e),render(){const{mergedClsPrefix:e}=this;return a("label",{class:[`${e}-radio-button`,{[`${e}-radio-button--disabled`]:this.mergedDisabled,[`${e}-radio-button--checked`]:this.renderSafeChecked,[`${e}-radio-button--focus`]:this.focus}]},a("input",{ref:"inputRef",type:"radio",class:`${e}-radio-input`,value:this.value,name:this.mergedName,checked:this.renderSafeChecked,disabled:this.mergedDisabled,onChange:this.handleRadioInputChange,onFocus:this.handleRadioInputFocus,onBlur:this.handleRadioInputBlur}),a("div",{class:`${e}-radio-button__state-border`}),t(this.$slots.default,(t=>t||this.label?a("div",{ref:"labelRef",class:`${e}-radio__label`},t||this.label):null)))}});const q=e({components:{NForm:$,NFormItem:I,NInput:o,NButton:r,NRadioGroup:B,NRadioButton:j},setup(){s();const e=d(),{t:a}=n(),t=i({username:"",password:"",gender:"",email:"",code:""}),l=F();let o=u(!1),r=u(!1);const m=(e,a)=>{l[e]({content:a,duration:2e3})};return{loadingCode:o,loadingRegister:r,formState:t,rules:{username:{required:!0,trigger:"blur",message:""},password:{required:!0,trigger:"blur",message:""},gender:{required:!0,trigger:"blur",message:""},email:{required:!0,trigger:"blur",message:""},code:{required:!0,trigger:"blur",message:""}},handleSubmit:async function(){r.value=!0;let a=await v({username:t.username,password:t.password,email:t.email,gender:"Boy"===t.gender?1:0,code:t.code,nowTime:Date.now()});console.log(a),200==a.status?e.push("/login"):m("error",a.message),r.value=!1},handleBack:function(){e.push("/login")},invalidForm:function(){let{username:e,password:a,gender:l,email:o,code:r}=t;return""===e||""===a||""===l||""===o||""===r},t:a,invalidCode:function(){let{email:e}=t;return""===e},getCode:async()=>{o.value=!0;let e=localStorage.getItem("codeExpire");if(Date.now()<Number(e))return m("warning","验证码已发送, 请勿频繁获取, 请5分钟后再试"),void(o.value=!1);if(/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/.test(t.email)){let e=await h({email:t.email});if(400==e.status)m("error",e.message);else{let e=await b({email:t.email});if(200==e.status){m("success",e.message);let a=e.data.expire;localStorage.setItem("codeExpire",a)}else m("error",e.message)}}else m("error","邮箱格式有误, 请检查后再试");o.value=!1},genders:[{value:"Boy",label:"Boy"},{value:"Gril",label:"Gril"}],updateChecked:e=>{t.gender=e.target.value}}}}),U=e=>(k("data-v-5a101664"),e=e(),y(),e),Z={class:"i-container"},z=U((()=>N("h1",null,"注册",-1))),A=U((()=>N("div",{class:"gender-label"},"性别",-1))),D=_(" 获取 ");var G=l(q,[["render",function(e,a,t,l,o,r){const s=m("n-input"),d=m("n-form-item"),n=m("n-radio-button"),i=m("n-radio-group"),u=m("n-button"),h=m("n-form");return p(),c("div",Z,[g(h,{model:e.formState,rules:e.rules,class:"i-form","label-placement":"left"},{default:f((()=>[z,g(d,{path:"username"},{default:f((()=>[g(s,{value:e.formState.username,"onUpdate:value":a[0]||(a[0]=a=>e.formState.username=a),placeholder:e.t("common.username"),"input-props":{autocomplete:"off"}},null,8,["value","placeholder"])])),_:1}),g(d,{path:"password"},{default:f((()=>[g(s,{value:e.formState.password,"onUpdate:value":a[1]||(a[1]=a=>e.formState.password=a),type:"password",placeholder:e.t("common.password"),"input-props":{autocomplete:"off"}},null,8,["value","placeholder"])])),_:1}),g(d,{path:"gender"},{default:f((()=>[A,g(i,{value:e.formState.gender,"onUpdate:value":a[2]||(a[2]=a=>e.formState.gender=a),name:"radiobuttongroup1"},{default:f((()=>[(p(!0),c(C,null,w(e.genders,(a=>(p(),R(n,{key:a.value,value:a.value,label:a.label,onChange:e.updateChecked},null,8,["value","label","onChange"])))),128))])),_:1},8,["value"])])),_:1}),g(d,{path:"email"},{default:f((()=>[g(s,{value:e.formState.email,"onUpdate:value":a[3]||(a[3]=a=>e.formState.email=a),placeholder:e.t("common.email"),"input-props":{autocomplete:"off"}},null,8,["value","placeholder"])])),_:1}),g(d,{path:"code"},{default:f((()=>[g(u,{type:"primary",loading:e.loadingCode,style:{width:"120px","margin-right":"20px"},disabled:e.invalidCode(),onClick:e.getCode},{default:f((()=>[D])),_:1},8,["loading","disabled","onClick"]),g(s,{value:e.formState.code,"onUpdate:value":a[4]||(a[4]=a=>e.formState.code=a),placeholder:e.t("common.code"),"input-props":{autocomplete:"off"}},null,8,["value","placeholder"])])),_:1}),g(d,{class:"register-btn"},{default:f((()=>[g(u,{quaternary:"",style:{margin:"0 15px 0 0"},onClick:e.handleBack},{default:f((()=>[_(S(e.t("common.back")),1)])),_:1},8,["onClick"]),g(u,{type:"primary","attr-type":"submit",loading:e.loadingRegister,onClick:e.handleSubmit,disabled:e.invalidForm(),style:{width:"120px"}},{default:f((()=>[_(S(e.t("common.sign_up")),1)])),_:1},8,["loading","onClick","disabled"])])),_:1})])),_:1},8,["model","rules"])])}],["__scopeId","data-v-5a101664"]]);export{G as default};
